<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.82.0" />
    <meta name="description" content="">
<meta name="author" content="Hugh Cross">

    <link rel="icon" href="/hacky2021/images/favicon.png" type="image/png">

    <title>Data management :: Hacky Hour 2021</title>

    
    <link href="/hacky2021/css/nucleus.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/fontawesome-all.min.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/hybrid.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/featherlight.min.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/perfect-scrollbar.min.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/auto-complete.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/atom-one-dark-reasonable.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/theme.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/tabs.css?1626131305" rel="stylesheet">
    <link href="/hacky2021/css/hugo-theme.css?1626131305" rel="stylesheet">
    
    <link href="/hacky2021/css/theme-green.css?1626131305" rel="stylesheet">
    
    

    <script src="/hacky2021/js/jquery-3.3.1.min.js?1626131305"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/hacky2021/sessions/0713_data_management/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <figure>
    <img src='media/yellow_penguin.jpg' alt='Hacky Hour 2021' />
    <figcaption><a href="https://otagomohio.github.io/hacky2021/"><font color="white" face="Garamond, sans-serif" size="+2">Hacky Hour 2021</font></a></figcaption>
</figure>
    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/hacky2021/js/lunr.min.js?1626131305"></script>
<script type="text/javascript" src="/hacky2021/js/auto-complete.js?1626131305"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/otagomohio.github.io\/hacky2021\/";
    
</script>
<script type="text/javascript" src="/hacky2021/js/search.js?1626131305"></script>

    
  </div>
  

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/hacky2021/basics/" title="Basics" class="dd-item
        
        
        
        ">
      <a href="/hacky2021/basics/">
          <i class="fas fa-wrench"></i> Basics
          
      </a>
      
      
        <ul>
          
          
            
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/basics/transferring_files/" title="Transferring Files" class="dd-item ">
        <a href="/hacky2021/basics/transferring_files/">
        Transferring Files
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/hacky2021/basics/tmux_basics/" title="Tmux basics" class="dd-item
        
        
        
        ">
      <a href="/hacky2021/basics/tmux_basics/">
          Tmux basics
          
      </a>
      
      
    </li>
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/basics/regular_expressions/" title="Regular expressions" class="dd-item ">
        <a href="/hacky2021/basics/regular_expressions/">
        Regular expressions
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/basics/shell_scripting_basics/" title="Shell scripting basics" class="dd-item ">
        <a href="/hacky2021/basics/shell_scripting_basics/">
        Shell scripting basics
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/hacky2021/nesi/" title="NeSI" class="dd-item
        
        
        
        ">
      <a href="/hacky2021/nesi/">
          <i class="fab fa-mixcloud"></i> NeSI
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/nesi/nesi_links/" title="NeSI Links" class="dd-item ">
        <a href="/hacky2021/nesi/nesi_links/">
        NeSI Links
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/nesi/collaboration_server/" title="Collaboration on NeSI" class="dd-item ">
        <a href="/hacky2021/nesi/collaboration_server/">
        Collaboration on NeSI
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/hacky2021/sessions/" title="Sessions" class="dd-item
        parent
        
        
        ">
      <a href="/hacky2021/sessions/">
          <i class="fas fa-users"></i> Sessions
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/sessions/0713_data_management/" title="Data management" class="dd-item active">
        <a href="/hacky2021/sessions/0713_data_management/">
        Data management
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/hacky2021/bugs/" title="Debugging" class="dd-item
        
        
        
        ">
      <a href="/hacky2021/bugs/">
          <i class="fas fa-bug"></i> Debugging
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/bugs/troubleshooting/" title="Troubleshooting errors" class="dd-item ">
        <a href="/hacky2021/bugs/troubleshooting/">
        Troubleshooting errors
        
        </a>
    </li>
     
  
 

            
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/bugs/getting_help/" title="Getting help" class="dd-item ">
        <a href="/hacky2021/bugs/getting_help/">
        Getting help
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/hacky2021/concepts/" title="Concepts" class="dd-item
        
        
        
        ">
      <a href="/hacky2021/concepts/">
          <i class="fas fa-yin-yang"></i> Concepts
          
      </a>
      
      
        <ul>
          
          
          

        
          
            
            




 
  
    
      <li data-nav-id="/hacky2021/concepts/building_blocks/" title="Building blocks" class="dd-item ">
        <a href="/hacky2021/concepts/building_blocks/">
        Building blocks
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
      
    </li>
  
 

          
        
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fas fa-heart"></i></a> from <a href="https://getgrav.org">Grav</a> and <a href="https://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/hacky2021/'>Hacky Hour 2021</a> > <a href='/hacky2021/sessions/'>Sessions</a> > Data management
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#description">Description</a></li>
      </ul>
    </li>
    <li><a href="#good-habits">Good habits</a></li>
    <li><a href="#tips-and-tricks-for-data-management-on-nesi">Tips and tricks for data management on NeSI</a></li>
    <li><a href="#links">Links</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Data management
            </h1>
          

        


<p>Ludovic Dutoit, July 2021</p>
<h3 id="description">Description</h3>
<p>This session covers the essential of data management for a project on NeSI. It starts with a bit of general thinking before moving into some <a href="https://www.nesi.org.nz/">NeSI</a> specifics.</p>
<h2 id="good-habits">Good habits</h2>
<ul>
<li>Always have your data in at least two places.</li>
<li>Never edit your raw data.</li>
<li>Use informative file names: <code>filtered_data.txt</code>is meaningless on its own. <code>data_noMISSINGDATAremoved12lowqual.csv</code> is much better.</li>
<li>Avoid proprietary formats</li>
<li>Have a readme file</li>
<li>Your methods are easily transportable, and should bring anyone from raw data to results. Put your efforts there, Try to see files as checkpoints, not at the center of your structure.</li>
<li>Use version control (i.e. github.com)</li>
</ul>
<h2 id="tips-and-tricks-for-data-management-on-nesi">Tips and tricks for data management on NeSI</h2>
<p>If you do not have access to NeSI yet, apply <a href="https://www.nesi.org.nz/">here</a>. Free, powerful, and maintained for you!</p>
<p>There are essentially 3 file systems on NeSI.</p>
<p>They are explained <a href="https://support.nesi.org.nz/hc/en-gb/articles/360000177256-NeSI-File-Systems-and-Quotas">here</a>.</p>
<p><strong>How to check your usage?</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">nn_storage_quota <span style="color:#75715e"># check your quotas, specific to NeSI</span>
du -h <span style="color:#75715e"># Show the size of every directory in the data structure.</span>
du -h | grep -E <span style="color:#e6db74">&#34;^[0-9]+G&#34;</span> <span style="color:#75715e"># check all the directories in the Gb range</span>
</code></pre></div><p>That is all good and well, but we sometimes end up with huge quantity of small files, can we have an infinity of those? No, files are assiocated to metadata, an empty file still takes some space for metadata on the system. That space is referred to as <strong>inodes</strong>, and they can also reach a quota.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">nn_storage_quota
echo <span style="color:#e6db74">&#34;Inode usage for </span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> ; <span style="color:#66d9ef">for</span> d in <span style="color:#e6db74">`</span>find -maxdepth <span style="color:#ae81ff">1</span> -type d | cut -d<span style="color:#ae81ff">\/</span> -f2 | grep -xv . | sort<span style="color:#e6db74">`</span>; <span style="color:#66d9ef">do</span> c<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>find $d | wc -l<span style="color:#66d9ef">)</span> ; printf <span style="color:#e6db74">&#34;</span>$c<span style="color:#e6db74">\t\t- </span>$d<span style="color:#e6db74">\n&#34;</span> ; <span style="color:#66d9ef">done</span> ; printf <span style="color:#e6db74">&#34;Total: \t\t</span><span style="color:#66d9ef">$(</span>find <span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span> | wc -l<span style="color:#66d9ef">)</span><span style="color:#e6db74">\n&#34;</span> <span style="color:#75715e"># This counts the inodes</span>
</code></pre></div><p><strong>Where are those backups anyway?</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd  <span style="color:#75715e"># Brings you home</span>
cd .snapshots
ls -lh 
</code></pre></div><p>You got one week of backups there. Whether it is that exact folder or its content.</p>
<p>Same inside the <code>/nesi/project/</code> but not in &lsquo;nobackup&rsquo;</p>
<h2 id="links">Links</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd /nesi/nobackup/uooXXXXX <span style="color:#75715e"># go to your nobackup directory</span>
mkdir tmp_data
touch sample<span style="color:#f92672">{</span>0001..1000<span style="color:#f92672">}</span>.fastq
</code></pre></div><p>Wow, we have a 1000 files here. You&rsquo;d like to use them from your nobackup inside your normal project</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sh" data-lang="sh">cd  /nesi/project/uooXXXXX <span style="color:#75715e"># go to your  project directory</span>
</code></pre></div><p>Let&rsquo;s create a link:</p>
<pre><code>ln -s  /nesi/nobackup/uooXXXXX/tmp_data/ . # create a soft link here. &quot;.&quot; is for here
</code></pre><p>Have a look inside:</p>
<pre><code>ld -lh
ls -lh tmp_data/
</code></pre><p>Yay it is all here, we basically created a shortcut without duplicating the files.</p>
<p>Let&rsquo;s remove it now:</p>
<pre><code>rm -r  tmp_data/ # -r is needed to remove a directory
</code></pre><p>Is the original folder still there?</p>
<pre><code>ls -lh  /nesi/nobackup/uooXXXXX/tmp_data/
</code></pre><p>YES!</p>
<p>Still not enough space? Ask <a href="support@nesi.org.nz">support@nesi.org.nz</a> first, if it is not enough, you can get data on the <a href="https://www.otago.ac.nz/its/services/hosting/otago068353.html">high capacity storage (HCS)</a> of the university too.</p>


<footer class="footline">
	
</footer>

        
        </div>
        

      </div>

    <div id="navigation">
        
        

        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        

        


	 
	 
		
			<a class="nav nav-prev" href="/hacky2021/sessions/" title="Sessions"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/hacky2021/bugs/" title="Debugging" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>

    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/hacky2021/js/clipboard.min.js?1626131305"></script>
    <script src="/hacky2021/js/perfect-scrollbar.min.js?1626131305"></script>
    <script src="/hacky2021/js/perfect-scrollbar.jquery.min.js?1626131305"></script>
    <script src="/hacky2021/js/jquery.sticky.js?1626131305"></script>
    <script src="/hacky2021/js/featherlight.min.js?1626131305"></script>
    <script src="/hacky2021/js/highlight.pack.js?1626131305"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/hacky2021/js/modernizr.custom-3.6.0.js?1626131305"></script>
    <script src="/hacky2021/js/learn.js?1626131305"></script>
    <script src="/hacky2021/js/hugo-learn.js?1626131305"></script>
    
        
            <script src="/hacky2021/mermaid/mermaid.js?1626131305"></script>
        
        <script>
            mermaid.initialize({ startOnLoad: true });
        </script>
    
    

  </body>
</html>

