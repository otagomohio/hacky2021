<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.85.0"><meta name=description content><meta name=author content="Hugh Cross"><link rel=icon href=/hacky2021/images/favicon.png type=image/png><title>Data management :: Hacky Hour 2021</title><link href=/hacky2021/css/nucleus.css?1626133360 rel=stylesheet><link href=/hacky2021/css/fontawesome-all.min.css?1626133360 rel=stylesheet><link href=/hacky2021/css/hybrid.css?1626133360 rel=stylesheet><link href=/hacky2021/css/featherlight.min.css?1626133360 rel=stylesheet><link href=/hacky2021/css/perfect-scrollbar.min.css?1626133360 rel=stylesheet><link href=/hacky2021/css/auto-complete.css?1626133360 rel=stylesheet><link href=/hacky2021/css/atom-one-dark-reasonable.css?1626133360 rel=stylesheet><link href=/hacky2021/css/theme.css?1626133360 rel=stylesheet><link href=/hacky2021/css/tabs.css?1626133360 rel=stylesheet><link href=/hacky2021/css/hugo-theme.css?1626133360 rel=stylesheet><link href=/hacky2021/css/theme-green.css?1626133360 rel=stylesheet><script src=/hacky2021/js/jquery-3.3.1.min.js?1626133360></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/hacky2021/sessions/0713_data_management/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><svg id="grav-logo" style="width:100%;height:100%" viewBox="0 0 504 140" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:1.41421"><path d="M235.832 71.564l-7.98-.001c-1.213.001-2.197.987-2.197 2.204v15.327l-.158.132c-4.696 3.962-10.634 6.14-16.719 6.14-14.356.0-26.034-11.68-26.034-26.037.0-14.358 11.678-26.035 26.034-26.035 5.582.0 10.919 1.767 15.437 5.113.877.649 2.093.56 2.866-.211l5.69-5.69c.444-.442.675-1.055.639-1.681-.034-.627-.336-1.206-.828-1.597-6.76-5.363-15.214-8.314-23.805-8.314-21.18.0-38.414 17.233-38.414 38.415.0 21.183 17.234 38.415 38.414 38.415 10.937.0 21.397-4.705 28.698-12.914.358-.403.556-.921.556-1.46V73.767c0-1.217-.985-2.203-2.2-2.203" style="fill:#000;fill-rule:nonzero"/><path d="M502.794 34.445c-.408-.616-1.1-.989-1.838-.989h-8.684c-.879.0-1.673.522-2.022 1.329l-24.483 56.839-24.92-56.852c-.352-.799-1.142-1.316-2.012-1.316h-8.713c-.744.0-1.44.373-1.843.995-.408.623-.476 1.408-.174 2.09l30.186 68.858c.352.799 1.143 1.317 2.017 1.317H471.3c.879.0 1.673-.527 2.021-1.329l29.655-68.861c.289-.68.222-1.461-.182-2.081" style="fill:#000;fill-rule:nonzero"/><path d="M388.683 34.772c-.353-.798-1.142-1.316-2.017-1.316h-10.988c-.879.0-1.673.522-2.021 1.329l-29.655 68.861c-.294.675-.226 1.46.182 2.077.407.619 1.096.993 1.838.993h8.684c.879.0 1.673-.526 2.022-1.329l24.478-56.842 24.92 56.854c.353.798 1.143 1.317 2.013 1.317h8.717c.744.0 1.44-.374 1.843-.993.408-.624.471-1.41.174-2.094l-30.19-68.857z" style="fill:#000;fill-rule:nonzero"/><path d="M309.196 81.525l.476-.229c8.675-4.191 14.279-13.087 14.279-22.667.0-13.881-11.295-25.174-25.176-25.174h-31.863c-1.214.0-2.199.988-2.199 2.202v68.855c0 1.219.985 2.204 2.199 2.204h7.979c1.214.0 2.2-.985 2.2-2.204V45.833h21.684c7.059.0 12.799 5.739 12.799 12.796.0 5.885-3.996 10.989-9.728 12.408-1.032.261-2.064.393-3.071.393h-7.977c-.829.0-1.585.467-1.959 1.205-.378.74-.305 1.625.187 2.296l22.62 30.884c.412.566 1.07.901 1.771.901h9.915c.827.0 1.587-.467 1.96-1.207.378-.742.302-1.629-.186-2.296l-15.91-21.688z" style="fill:#000;fill-rule:nonzero"/><path d="M107.191 80.969c-7.255-4.794-11.4-8.845-15.011-16.109-2.47 4.977-8.236 12.376-17.962 18.198-4.856 15.106-27.954 44.015-35.43 39.916-2.213-1.212-2.633-2.808-2.133-4.456.536-4.129 9.078-13.62 9.078-13.62s.18 1.992 2.913 6.187c-3.609-11.205 5.965-25.031 8.5-29.738 3.985-1.269 4.274-6.387 4.274-6.387.255-7.909-3.278-13.635-6.701-17.059 2.459 3.002 3.255 7.539 3.372 11.694v.023c.012.469.012.93.011 1.39-.117 3.439-1.157 8.19-3.383 8.19l.006.03c-2.289-.098-5.115.391-7.639 1.18l-5.582 1.334s2.977-.136 4.584 1.252c-1.79 2.915-5.769 6.533-10.206 8.588-6.457 2.995-8.312-2.964-5.034-6.838.805-.946 1.618-1.745 2.387-2.399-.495-.513-.807-1.198-.889-2.068-.001-.005-.004-.009-.005-.013-.45-1.977-.202-4.543 2.596-8.623.551-.863 1.214-1.748 2.007-2.647.025-.031.046-.059.072-.089.034-.042.072-.08.108-.121.02-.023.039-.045.059-.068.2-.228.413-.45.639-.663 3.334-3.414 8.599-6.966 16.897-10.152 9.675-14.223 13.219-16.89 13.219-16.89 1.071-1.096 2.943-2.458 3.632-2.805-5.053-8.781-6.074-21.158-4.75-24.493-.107.18-.206.365-.287.556.49-1.143.819-1.509 1.328-2.111 1.381-1.632 6.058-2.488 7.737.971.895 1.844 1.063 4.232 1.034 6.023-3.704-.193-7.063 4.036-7.063 4.036s3.067-1.448 6.879-1.473c0 0 1.015.883 2.283 2.542-1.712 3.213-4.524 10.021-2.488 17.168.338 1.408.849 2.619 1.483 3.648.024.045.044.089.069.135.051.066.096.122.144.183 3.368 5.072 9.542 5.665 9.542 5.665-2.906-1.45-5.274-3.76-6.816-6.56-.8-1.498-1.291-2.762-1.592-3.761-1.636-6.313.771-9.999 2.149-12.471 3.17-4.917 8.944-7.893 15.151-7.185 8.712.995 14.968 8.862 13.973 17.571-.608 5.321-3.781 9.723-8.142 12.117 1.049 2.839-.073 6.28-.073 6.28 2.642 3.323 2.758 5.238 2.667 7.017-3.357-.565-6.618 1.701-6.618 1.701s6.476-1.546 10.238 1.81c2.446 2.631 4.078 5.009 5.051 6.766 1.393 2.505 7.859 2.683 7.123 7.188-.737 4.499-5.669 4.542-13.401-.56M69.571.0C31.147.0.0 31.148.0 69.567c0 38.422 31.147 69.573 69.571 69.573 38.42.0 69.568-31.151 69.568-69.573C139.139 31.147 107.991.0 69.571.0" style="fill:#000;fill-rule:nonzero"/><path d="M73.796 51.693c.813-.814.813-2.134.0-2.947-.815-.814-2.133-.814-2.947.0-.815.813-.815 2.133.0 2.947.814.813 2.132.813 2.947.0" style="fill:#000;fill-rule:nonzero"/><path d="M66.445 53.149c-.814.813-.814 2.133.0 2.947.813.814 2.133.814 2.947.0.813-.814.813-2.134.0-2.947-.814-.813-2.134-.813-2.947.0" style="fill:#000;fill-rule:nonzero"/><path d="M79.231 54.233c-1.274-1.274-3.339-1.272-4.611.0l-2.713 2.712c-1.274 1.275-1.274 3.339.0 4.612l2.978 2.978c1.274 1.275 3.338 1.274 4.611.0l2.712-2.712c1.274-1.274 1.274-3.339.0-4.612l-2.977-2.978z" style="fill:#000;fill-rule:nonzero"/><path d="M95.759 41.445c-2.151-2.578 1.869-7.257 4.391-4.463 4.645 5.148-2.237 7.041-4.391 4.463M105.004 44.132c3.442-6.553-1.427-10.381-4.773-13.523-5.36-5.039-10.706-7.217-16.811-.241-6.102 6.977-2.226 15.068 3.356 19.061 5.584 3.994 14.782 1.255 18.228-5.297" style="fill:#000;fill-rule:nonzero"/></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/hacky2021/js/lunr.min.js?1626133360></script><script type=text/javascript src=/hacky2021/js/auto-complete.js?1626133360></script><script type=text/javascript>var baseurl="https://otagomohio.github.io/hacky2021/"</script><script type=text/javascript src=/hacky2021/js/search.js?1626133360></script></div><div class=highlightable><ul class=topics><li data-nav-id=/hacky2021/basics/ title=Basics class=dd-item><a href=/hacky2021/basics/><i class="fas fa-wrench"></i> Basics</a><ul><li data-nav-id=/hacky2021/basics/transferring_files/ title="Transferring Files" class=dd-item><a href=/hacky2021/basics/transferring_files/>Transferring Files</a></li><li data-nav-id=/hacky2021/basics/tmux_basics/ title="Tmux basics" class=dd-item><a href=/hacky2021/basics/tmux_basics/>Tmux basics</a></li><li data-nav-id=/hacky2021/basics/regular_expressions/ title="Regular expressions" class=dd-item><a href=/hacky2021/basics/regular_expressions/>Regular expressions</a></li><li data-nav-id=/hacky2021/basics/shell_scripting_basics/ title="Shell scripting basics" class=dd-item><a href=/hacky2021/basics/shell_scripting_basics/>Shell scripting basics</a></li></ul></li><li data-nav-id=/hacky2021/sessions/ title=Sessions class="dd-item
parent"><a href=/hacky2021/sessions/><i class="fas fa-users"></i> Sessions</a><ul><li data-nav-id=/hacky2021/sessions/0713_data_management/ title="Data management" class="dd-item active"><a href=/hacky2021/sessions/0713_data_management/>Data management</a></li></ul></li><li data-nav-id=/hacky2021/nesi/ title=NeSI class=dd-item><a href=/hacky2021/nesi/><i class="fab fa-mixcloud"></i> NeSI</a><ul><li data-nav-id=/hacky2021/nesi/nesi_links/ title="NeSI Links" class=dd-item><a href=/hacky2021/nesi/nesi_links/>NeSI Links</a></li><li data-nav-id=/hacky2021/nesi/collaboration_server/ title="Collaboration on NeSI" class=dd-item><a href=/hacky2021/nesi/collaboration_server/>Collaboration on NeSI</a></li></ul></li><li data-nav-id=/hacky2021/bugs/ title=Debugging class=dd-item><a href=/hacky2021/bugs/><i class="fas fa-bug"></i> Debugging</a><ul><li data-nav-id=/hacky2021/bugs/troubleshooting/ title="Troubleshooting errors" class=dd-item><a href=/hacky2021/bugs/troubleshooting/>Troubleshooting errors</a></li><li data-nav-id=/hacky2021/bugs/getting_help/ title="Getting help" class=dd-item><a href=/hacky2021/bugs/getting_help/>Getting help</a></li></ul></li><li data-nav-id=/hacky2021/concepts/ title=Concepts class=dd-item><a href=/hacky2021/concepts/><i class="fas fa-yin-yang"></i> Concepts</a><ul><li data-nav-id=/hacky2021/concepts/building_blocks/ title="Building blocks" class=dd-item><a href=/hacky2021/concepts/building_blocks/>Building blocks</a></li></ul></li></ul><section id=footer><p>Built with <a href=https://github.com/matcornic/hugo-theme-learn><i class="fas fa-heart"></i></a> from <a href=https://getgrav.org>Grav</a> and <a href=https://gohugo.io/>Hugo</a></p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/hacky2021/>Hacky Hour 2021</a> > <a href=/hacky2021/sessions/>Sessions</a> > Data management</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><ul><li><a href=#description>Description</a></li></ul></li><li><a href=#good-habits>Good habits</a></li><li><a href=#tips-and-tricks-for-data-management-on-nesi>Tips and tricks for data management on NeSI</a></li><li><a href=#links>Links</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Data management</h1><p>Ludovic Dutoit, July 2021</p><h3 id=description>Description</h3><p>This session covers the essential of data management for a project on NeSI. It starts with a bit of general thinking before moving into some <a href=https://www.nesi.org.nz/>NeSI</a> specifics.</p><h2 id=good-habits>Good habits</h2><ul><li>Always have your data in at least two places.</li><li>Never edit your raw data.</li><li>Use informative file names: <code>filtered_data.txt</code>is meaningless on its own. <code>data_noMISSINGDATAremoved12lowqual.csv</code> is much better.</li><li>Avoid proprietary formats</li><li>Have a readme file</li><li>Your methods are easily transportable, and should bring anyone from raw data to results. Put your efforts there, Try to see files as checkpoints, not at the center of your structure.</li><li>Use version control (i.e. github.com)</li></ul><h2 id=tips-and-tricks-for-data-management-on-nesi>Tips and tricks for data management on NeSI</h2><p>If you do not have access to NeSI yet, apply <a href=https://www.nesi.org.nz/>here</a>. Free, powerful, and maintained for you!</p><p>There are essentially 3 file systems on NeSI.</p><p>They are explained <a href=https://support.nesi.org.nz/hc/en-gb/articles/360000177256-NeSI-File-Systems-and-Quotas>here</a>.</p><p><strong>How to check your usage?</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nn_storage_quota <span style=color:#75715e># check your quotas, specific to NeSI</span>
du -h <span style=color:#75715e># Show the size of every directory in the data structure.</span>
du -h | grep -E <span style=color:#e6db74>&#34;^[0-9]+G&#34;</span> <span style=color:#75715e># check all the directories in the Gb range</span>
</code></pre></div><p>That is all good and well, but we sometimes end up with huge quantity of small files, can we have an infinity of those? No, files are assiocated to metadata, an empty file still takes some space for metadata on the system. That space is referred to as <strong>inodes</strong>, and they can also reach a quota.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nn_storage_quota
echo <span style=color:#e6db74>&#34;Inode usage for </span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span> ; <span style=color:#66d9ef>for</span> d in <span style=color:#e6db74>`</span>find -maxdepth <span style=color:#ae81ff>1</span> -type d | cut -d<span style=color:#ae81ff>\/</span> -f2 | grep -xv . | sort<span style=color:#e6db74>`</span>; <span style=color:#66d9ef>do</span> c<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>find $d | wc -l<span style=color:#66d9ef>)</span> ; printf <span style=color:#e6db74>&#34;</span>$c<span style=color:#e6db74>\t\t- </span>$d<span style=color:#e6db74>\n&#34;</span> ; <span style=color:#66d9ef>done</span> ; printf <span style=color:#e6db74>&#34;Total: \t\t</span><span style=color:#66d9ef>$(</span>find <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span> | wc -l<span style=color:#66d9ef>)</span><span style=color:#e6db74>\n&#34;</span> <span style=color:#75715e># This counts the inodes</span>
</code></pre></div><p><strong>Where are those backups anyway?</strong></p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cd  <span style=color:#75715e># Brings you home</span>
cd .snapshots
ls -lh 
</code></pre></div><p>You got one week of backups there. Whether it is that exact folder or its content.</p><p>Same inside the <code>/nesi/project/</code> but not in &lsquo;nobackup&rsquo;</p><h2 id=links>Links</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cd /nesi/nobackup/uooXXXXX <span style=color:#75715e># go to your nobackup directory</span>
mkdir tmp_data
touch sample<span style=color:#f92672>{</span>0001..1000<span style=color:#f92672>}</span>.fastq
</code></pre></div><p>Wow, we have a 1000 files here. You&rsquo;d like to use them from your nobackup inside your normal project</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>cd  /nesi/project/uooXXXXX <span style=color:#75715e># go to your  project directory</span>
</code></pre></div><p>Let&rsquo;s create a link:</p><pre><code>ln -s  /nesi/nobackup/uooXXXXX/tmp_data/ . # create a soft link here. &quot;.&quot; is for here
</code></pre><p>Have a look inside:</p><pre><code>ld -lh
ls -lh tmp_data/
</code></pre><p>Yay it is all here, we basically created a shortcut without duplicating the files.</p><p>Let&rsquo;s remove it now:</p><pre><code>rm -r  tmp_data/ # -r is needed to remove a directory
</code></pre><p>Is the original folder still there?</p><pre><code>ls -lh  /nesi/nobackup/uooXXXXX/tmp_data/
</code></pre><p>YES!</p><p>Still not enough space? Ask <a href=support@nesi.org.nz>support@nesi.org.nz</a> first, if it is not enough, you can get data on the <a href=https://www.otago.ac.nz/its/services/hosting/otago068353.html>high capacity storage (HCS)</a> of the university too.</p><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/hacky2021/sessions/ title=Sessions><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/hacky2021/nesi/ title=NeSI style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/hacky2021/js/clipboard.min.js?1626133360></script><script src=/hacky2021/js/perfect-scrollbar.min.js?1626133360></script><script src=/hacky2021/js/perfect-scrollbar.jquery.min.js?1626133360></script><script src=/hacky2021/js/jquery.sticky.js?1626133360></script><script src=/hacky2021/js/featherlight.min.js?1626133360></script><script src=/hacky2021/js/highlight.pack.js?1626133360></script><script>hljs.initHighlightingOnLoad()</script><script src=/hacky2021/js/modernizr.custom-3.6.0.js?1626133360></script><script src=/hacky2021/js/learn.js?1626133360></script><script src=/hacky2021/js/hugo-learn.js?1626133360></script><script src=/hacky2021/mermaid/mermaid.js?1626133360></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>